<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=https://www.xlabs.club/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://www.xlabs.club/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://www.xlabs.club/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><link rel=preconnect href=https://KMWY81ZWS3-dsn.algolia.net crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href=/main.2aa5335cee60a9df953606d981be5d3bef2c11c1bb63b8a1adca2daeaa34638efbddf90c070f0a73b0de86940e7c842295e72a4d45bb5a9387f2f154e5d29d09.css integrity="sha512-KqUzXO5gqd+VNgbZgb5dO+8sEcG7Y7ihrcotrqo0Y4773fkMBw8Kc7DehpQOfIQilecqTUW7WpOH8vFU5dKdCQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=https://www.xlabs.club/docs/java/%E4%BD%BF%E7%94%A8-openrewrite-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/><link rel=canonical href=https://www.xlabs.club/docs/java/%E4%BD%BF%E7%94%A8-openrewrite-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/><title>使用 OpenRewrite 进行代码重构 — Doks</title>
<meta name=description content="使用 OpenRewrite 进行代码重构"><link rel=icon href=/favicon-16x16.png sizes=16x16 type=image/png><link rel=icon href=/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/favicon-150x150.png sizes=150x150 type=image/png><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=icon href=/favicon.svg><link rel=mask-icon href=/mask-icon.svg color=white><meta property="og:title" content="使用 OpenRewrite 进行代码重构"><meta property="og:description" content="使用 OpenRewrite 进行代码重构"><meta property="og:type" content="article"><meta property="og:url" content="https://www.xlabs.club/docs/java/%E4%BD%BF%E7%94%A8-openrewrite-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/"><meta property="og:image" content="https://www.xlabs.club/cover.png"><meta property="article:section" content="docs"><meta property="article:published_time" content="2024-01-09T22:08:54+08:00"><meta property="article:modified_time" content="2024-01-09T22:08:54+08:00"><meta property="og:site_name" content="My Docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.xlabs.club/cover.png"><meta name=twitter:title content="使用 OpenRewrite 进行代码重构"><meta name=twitter:description content="使用 OpenRewrite 进行代码重构"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://www.xlabs.club/","name":"Build an Amazing Docs Site","position":1},{"@type":"ListItem","item":"https://www.xlabs.club/docs/","name":"Docs","position":2},{"@type":"ListItem","item":"https://www.xlabs.club/docs/java/","name":"Java","position":3},{"@type":"ListItem","name":"使用 Open Rewrite 进行代码重构","position":4}]}</script><script defer data-domain=getdoks.org src=https://plausible.io/js/script.js></script><meta name=bytedance-verification-code content="MLvJvgu8eINfBcFxGCcQ"></head><body class="single section docs" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-fluid><a class="navbar-brand me-auto me-lg-3" href=/><span class=visually-hidden>Doks</span><svg class="doks-images-light-mode svg-inline svg-inline-custom svg-lightmode" height="100%" width="70" viewBox="0 0 682 190" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#1d2d35"/></svg><svg class="doks-images-dark-mode svg-inline svg-inline-custom svg-darkmode" height="100%" width="70" viewBox="0 0 682 190" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#fff"/></svg></a><div id=docsearch class=d-none tabindex=-1 aria-disabled=true></div><button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Docs</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3d977af6029800a1bd3629ad45cccea2 aria-expanded=false>
平台工程</button><div class=collapse id=section-3d977af6029800a1bd3629ad45cccea2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E6%80%BB%E4%BD%93%E6%9E%B6%E6%9E%84/>总体架构</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E7%BB%9F%E4%B8%80%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81/>统一身份认证</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E5%BC%80%E5%8F%91%E8%80%85%E9%97%A8%E6%88%B7/>开发者门户</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E6%99%BA%E8%83%BD%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/>智能代码重构</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-03eadd6d06506d54fb81026b2f5963c8 aria-expanded=false>
云原生</button><div class=collapse id=section-03eadd6d06506d54fb81026b2f5963c8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/cloud/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/cloud/%E5%9F%BA%E4%BA%8E-envoy-%E7%9A%84%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1%E6%9C%8D%E5%8A%A1/>基于 Envoy 的智能路由服务</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d52387880e1ea22817a72d3759213819 aria-expanded=true>
Java</button><div class="collapse show" id=section-d52387880e1ea22817a72d3759213819><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/java/%E4%BB%8E-spring-%E5%88%B0-spring-boot/>从 Spring 到 Spring Boot</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/java/spring-boot-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87/>Spring Boot 自定义监控指标</a></li><li><a class="docs-link rounded active" href=https://www.xlabs.club/docs/java/%E4%BD%BF%E7%94%A8-openrewrite-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/>使用 OpenRewrite 进行代码重构</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-71bb54bbe3fa573fa0200737b4296024 aria-expanded=false>
Start Here</button><div class=collapse id=section-71bb54bbe3fa573fa0200737b4296024><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/getting-started/>Getting Started</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/environmental-impact/>Environmental Impact</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/upgrade-to-v1/>Upgrade to v1</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-bbc9105ee8508ce6e083a589a351e83a aria-expanded=false>
Basics</button><div class=collapse id=section-bbc9105ee8508ce6e083a589a351e83a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/project-structure/>Project Structure</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/authoring-content/>Authoring Content</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/shortcodes/>Shortcodes</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/navigation/>Navigation</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-7efb9866cc6ad242061889b460ca0bfd aria-expanded=false>
Built-ins</button><div class=collapse id=section-7efb9866cc6ad242061889b460ca0bfd><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/math/>Mathematical Expressions</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/diagrams/>Diagrams</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/code-blocks/>Code Blocks</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0153a1e369e543364edb1e75ceff1173 aria-expanded=false>
Recipes</button><div class=collapse id=section-0153a1e369e543364edb1e75ceff1173><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/deploy/>Deploy</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/analytics/>Analytics</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/cms/>CMS</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/docsearch/>DocSearch</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/versioning/>Versioning</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-45389ee90014e0938cb09409b9a8794d aria-expanded=false>
Guides</button><div class=collapse id=section-45389ee90014e0938cb09409b9a8794d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/tldr/>TL;DR</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/customization/>Customizing Doks</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/styles/>Styles</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/scripts/>Scripts</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/layouts/>Layouts</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/i18n/>Internationalization (i18n)</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/%E4%BB%8E-1024-%E5%88%B0-512/>从 1024 到 512</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-63d5049791d9d79d86e9a108b0a999ca aria-expanded=false>
Reference</button><div class=collapse id=section-63d5049791d9d79d86e9a108b0a999ca><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/configuration/>Configuration</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/frontmatter/>Frontmatter</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/markdown-basic-syntax/>Markdown Basic Syntax</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/markdown-extended-syntax/>Markdown Extended Syntax</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel><span class=visually-hidden>Doks</span><svg class="doks-images-light-mode svg-inline svg-inline-custom svg-lightmode" height="100%" width="60" viewBox="0 0 682 190" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#1d2d35"/></svg><svg class="doks-images-dark-mode svg-inline svg-inline-custom svg-darkmode" height="100%" width="60" viewBox="0 0 682 190" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#fff"/></svg></h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=https://www.xlabs.club/docs/start-here/getting-started/ aria-current=true>Docs</a></li><li class=nav-item><a class=nav-link href=https://www.xlabs.club/showcase/>Showcase</a></li><li class=nav-item><a class=nav-link href=https://www.xlabs.club/blog/>Blog</a></li><li class=nav-item><a target=blank class=nav-link href=https://github.com/gethyas/doks/discussions>Discussions<svg xmlns="http://www.w3.org/2000/svg" class="ms-1 mb-1 icon icon-tabler icon-tabler-external-link" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6H6A2 2 0 004 8v10a2 2 0 002 2h10a2 2 0 002-2v-6"/><path d="M11 13l9-9"/><path d="M15 4h5v5"/></svg></a></li><li class=nav-item><a target=blank class=nav-link href=https://gethyas.com>Hyas<svg xmlns="http://www.w3.org/2000/svg" class="ms-1 mb-1 icon icon-tabler icon-tabler-external-link" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6H6A2 2 0 004 8v10a2 2 0 002 2h10a2 2 0 002-2v-6"/><path d="M11 13l9-9"/><path d="M15 4h5v5"/></svg></a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link mx-2 d-none d-lg-block" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class="nav-item d-none d-lg-flex py-1 col-auto"><div class="vr h-100 mx-2 text-muted"></div></li><li class=nav-item><a rel=me class="nav-link social-link" href=https://github.com/gethyas/doks><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li><li class=nav-item><a rel=me class="nav-link social-link" href=https://fosstodon.org/@doks><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg><small class="ms-2 visually-hidden">Mastodon</small></a></li><li class=nav-item><a rel=me class="nav-link social-link" href=https://twitter.com/getdoks><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li></ul></div></div></div></header></div><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3d977af6029800a1bd3629ad45cccea2 aria-expanded=false>
平台工程</button><div class=collapse id=section-3d977af6029800a1bd3629ad45cccea2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E6%80%BB%E4%BD%93%E6%9E%B6%E6%9E%84/>总体架构</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E7%BB%9F%E4%B8%80%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81/>统一身份认证</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E5%BC%80%E5%8F%91%E8%80%85%E9%97%A8%E6%88%B7/>开发者门户</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/platform/%E6%99%BA%E8%83%BD%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/>智能代码重构</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-03eadd6d06506d54fb81026b2f5963c8 aria-expanded=false>
云原生</button><div class=collapse id=section-03eadd6d06506d54fb81026b2f5963c8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/cloud/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/cloud/%E5%9F%BA%E4%BA%8E-envoy-%E7%9A%84%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1%E6%9C%8D%E5%8A%A1/>基于 Envoy 的智能路由服务</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d52387880e1ea22817a72d3759213819 aria-expanded=true>
Java</button><div class="collapse show" id=section-d52387880e1ea22817a72d3759213819><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/java/%E4%BB%8E-spring-%E5%88%B0-spring-boot/>从 Spring 到 Spring Boot</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/java/spring-boot-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87/>Spring Boot 自定义监控指标</a></li><li><a class="docs-link rounded active" href=https://www.xlabs.club/docs/java/%E4%BD%BF%E7%94%A8-openrewrite-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/>使用 OpenRewrite 进行代码重构</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-71bb54bbe3fa573fa0200737b4296024 aria-expanded=false>
Start Here</button><div class=collapse id=section-71bb54bbe3fa573fa0200737b4296024><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/getting-started/>Getting Started</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/environmental-impact/>Environmental Impact</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/start-here/upgrade-to-v1/>Upgrade to v1</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-bbc9105ee8508ce6e083a589a351e83a aria-expanded=false>
Basics</button><div class=collapse id=section-bbc9105ee8508ce6e083a589a351e83a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/project-structure/>Project Structure</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/authoring-content/>Authoring Content</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/shortcodes/>Shortcodes</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/basics/navigation/>Navigation</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-7efb9866cc6ad242061889b460ca0bfd aria-expanded=false>
Built-ins</button><div class=collapse id=section-7efb9866cc6ad242061889b460ca0bfd><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/math/>Mathematical Expressions</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/diagrams/>Diagrams</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/built-ins/code-blocks/>Code Blocks</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0153a1e369e543364edb1e75ceff1173 aria-expanded=false>
Recipes</button><div class=collapse id=section-0153a1e369e543364edb1e75ceff1173><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/deploy/>Deploy</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/analytics/>Analytics</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/cms/>CMS</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/docsearch/>DocSearch</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/recipes/versioning/>Versioning</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-45389ee90014e0938cb09409b9a8794d aria-expanded=false>
Guides</button><div class=collapse id=section-45389ee90014e0938cb09409b9a8794d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/tldr/>TL;DR</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/customization/>Customizing Doks</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/styles/>Styles</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/scripts/>Scripts</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/layouts/>Layouts</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/i18n/>Internationalization (i18n)</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/guides/%E4%BB%8E-1024-%E5%88%B0-512/>从 1024 到 512</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-63d5049791d9d79d86e9a108b0a999ca aria-expanded=false>
Reference</button><div class=collapse id=section-63d5049791d9d79d86e9a108b0a999ca><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/configuration/>Configuration</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/frontmatter/>Frontmatter</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/markdown-basic-syntax/>Markdown Basic Syntax</a></li><li><a class="docs-link rounded" href=https://www.xlabs.club/docs/reference/markdown-extended-syntax/>Markdown Extended Syntax</a></li></ul></div></li></ul></nav></div><div class="col container-fw d-lg-flex flex-lg-row justify-content-center mx-auto"><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#openrewrite>OpenRewrite</a></li><li><a href=#spring-boot-migrator>Spring Boot Migrator</a></li><li><a href=#spring-到-spring-boot-迁移示例>Spring 到 Spring Boot 迁移示例</a></li><li><a href=#未完待续>未完待续</a></li></ul></nav></div><div class=feedback-links><h3>Give Feedback</h3><ul class=list-unstyled><li><a href=https://github.com/gethyas/doks/issues/new/choose>Create an issue</a></li><li><a href="https://github.com/gethyas/doks/discussions/new?category=ideas">Share an idea</a></li><li><a href="https://github.com/gethyas/doks/discussions/new?category=q-a">Ask a question</a></li></ul></div><script async src="https://cdn.carbonads.com/carbon.js?serve=CESIT5QY&placement=getdoksorg" id=_carbonads_js></script></nav><main class="docs-content col-lg-16 col-xl-9"><h1>使用 OpenRewrite 进行代码重构</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#openrewrite>OpenRewrite</a></li><li><a href=#spring-boot-migrator>Spring Boot Migrator</a></li><li><a href=#spring-到-spring-boot-迁移示例>Spring 到 Spring Boot 迁移示例</a></li><li><a href=#未完待续>未完待续</a></li></ul></nav></div></details></nav><p>作为一个以 Java 和 Spring 为主要技术栈的团队，在日常的软件开发中，我们经常会遇到一系列的组件升级和代码重构需求，诸如：</p><ul><li>项目级：整个项目（注此项目指 Maven Project）升级，而不是基于某个 Java 类或片段。</li><li>不同跨度变更：比如从 Spring 项目迁移到 Spring Boot，从 Spring Boot 2.x 升级到 3.x，从 Java 8 升级到 Java 21。</li><li>安全可靠：变更的代码一定是正确的，至少是逻辑正确的，至少不能像某 AI 助手一样设置一些根本不存在的属性。</li><li>经验产品化：比如我并（想）不了解 Spring Boot 3.2 具体有哪些变更，但希望能一键从 3.0 自动升级到 3.2，直接告诉有哪些变更。</li><li>自定义重构：对于某些自研代码，希望能自定义重构逻辑，一键自动重构。</li></ul><p>基于以上背景，我们探索了 <a href=https://docs.openrewrite.org/>OpenRewrite</a>、<a href=https://github.com/spring-projects-experimental/spring-boot-migrator>Spring Boot Migrator</a>、<a href=https://github.com/windup>Redhat Windup</a> 和一众不便具名的 AI 代码助手，本文将分享我们使用 OpenRewrite、Spring Boot Migrator 进行代码重构和升级的一些使用经验和体验。</p><h2 id=openrewrite>OpenRewrite<a href=#openrewrite class=anchor aria-hidden=true>#</a></h2><p><a href=https://docs.openrewrite.org/>OpenRewrite</a> 是一个开源的代码重写工具，旨在帮助开发人员自动化地重构和修改代码。</p><p>它提供了一套强大的 API 和插件系统，可以通过静态分析和代码转换技术来解析、修改和生成代码。OpenRewrite 支持多种编程语言，包括 Java、C#、 TypeScript、Python、Kubernetes 等。通过使用 OpenRewrite，开发人员可以轻松地进行代码重构、性能优化、代码风格调整和代码迁移等操作，从而提高代码质量和可维护性。OpenRewrite 的开源性质使得开发人员可以自由地定制和扩展其功能，以满足特定项目的需求。</p><p>比如 Java 领域一些热门的应用场景：</p><ul><li>Java 版本升级：从 Java 8 到 Java 17，从 Java EE 到 Jakarta EE 。</li><li>Spring 框架迁移：从 Spring 5 到 Spring 6，从 Spring Boot 2 到 Spring Boot 3。</li><li>测试框架迁移： 从 Junit 4 到 Junit 5。</li><li>依赖管理：自动更新 Java 项目的 Maven 或 Gradle 依赖，确保使用最新和最安全的库版本。</li><li>代码清理和格式化：自动清理和格式化 Java 代码，确保符合项目或组织的编码标准和风格指南。</li><li>修复安全漏洞：自动识别和修复 Java 代码中的已知安全漏洞，如使用了有安全问题的库或方法。</li><li>代码异味检测和修复：识别并自动重构 Java 代码中的“代码异味”，即不良编码实践，以提高代码可维护性。</li></ul><p>相比于时下火热的 AI 代码工具，比如 GitHub Copilot、Amazon CodeWhisperer，我认为 OpenRewrite 的优势主要有以下几点：</p><ul><li>可以直接处理大型项目，截止我写此文的今天还没一个成熟的 AI 助手能将整个项目一次性迁移或重构。</li><li>准确度较高，它通过预定义的规则来实现代码的精确修改，目前很多 AI 代码助手还在一本正经的瞎扯，尤其是凭空创造让人防不胜防。</li><li>可自定义扩展，对于自研代码不可能经过自动学习达到精确的效果，此时可自定义实现。</li><li>免费，可离线使用，便于 CI 集成。</li></ul><h2 id=spring-boot-migrator>Spring Boot Migrator<a href=#spring-boot-migrator class=anchor aria-hidden=true>#</a></h2><p>OpenRewrite 功能很强悍，但是仍缺失一项功能：将传统 Spring 项目一键迁移到 Spring Boot。</p><p>Spring Boot Migrator 基于 OpenRewrite，是一个专门用于协助将传统的 Spring 应用迁移到基于 Spring Boot 的工具，同时也提供 Spring Boot 的升级。</p><p>Spring Boot Migrator 程序运行起来后，通过 <code>list</code> 命令可以看到提供的 OpenRewrite recipes，其中主要关注的有：</p><ul><li>initialize-spring-boot-migration: 将项目初始化为 Spring Boot 应用。</li><li>migrate-spring-xml-to-java-config：将 Spring xml 转换为 Java 注解。</li><li>spring-context-xml-import：使用 Import xml 文件的形式初始化 Bean。</li><li>boot-2.7-3.0-dependency-version-update：Spring Boot 2 升级到 Spring Boot 3。</li></ul><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>migrator:&gt; list
</span></span></span><span class=line><span class=cl><span class=go>Found these recipes:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  1) remove-redundant-maven-compiler-plugin
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Remove standard maven-compiler plugin for applications with boot parent.
</span></span></span><span class=line><span class=cl><span class=go>  2) initialize-spring-boot-migration
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Initialize an application as Spring Boot application.
</span></span></span><span class=line><span class=cl><span class=go>  3) migrate-jndi-lookup
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate JNDI lookup using InitialContext to Spring Boot
</span></span></span><span class=line><span class=cl><span class=go>  4) migrate-jpa-to-spring-boot
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate JPA to Spring Boot
</span></span></span><span class=line><span class=cl><span class=go>  5) migrate-ejb-jar-deployment-descriptor
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Add or overrides @Stateless annotation as defined in ejb deployment descriptor
</span></span></span><span class=line><span class=cl><span class=go>  6) migrate-weblogic-ejb-deployment-descriptor
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate weblogic-ejb-jar.xml deployment descriptor
</span></span></span><span class=line><span class=cl><span class=go>  7) mark-and-clean-remote-ejbs
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Search @Stateless EJBs implementing a @Remote interface
</span></span></span><span class=line><span class=cl><span class=go>  8) migrate-stateless-ejb
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migration of stateless EJB to Spring components.
</span></span></span><span class=line><span class=cl><span class=go>  9) migrate-annotated-servlets
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Allow Spring Boot to deploy servlets annotated with @WebServlet
</span></span></span><span class=line><span class=cl><span class=go>  10) migrate-jax-ws
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate Jax Web-Service implementation to Spring Boot bases Web-Service
</span></span></span><span class=line><span class=cl><span class=go>  11) migrate-jax-rs
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Any class has import starting with javax.ws.rs
</span></span></span><span class=line><span class=cl><span class=go>  12) migrate-mule-to-boot
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate Mulesoft 3.9 to Spring Boot.
</span></span></span><span class=line><span class=cl><span class=go>  13) migrate-tx-to-spring-boot
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migration of @TransactionAttribute to @Transactionsl
</span></span></span><span class=line><span class=cl><span class=go>  14) spring-context-xml-import
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Import Spring Framework xml bean configuration into Java configuration without converting them.
</span></span></span><span class=line><span class=cl><span class=go>  15) migrate-spring-xml-to-java-config
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate Spring Framework xml bean configuration to Java configuration.
</span></span></span><span class=line><span class=cl><span class=go>  16) migrate-jms
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Convert JEE JMS app into Spring Boot JMS app
</span></span></span><span class=line><span class=cl><span class=go>  17) documentation-actions
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create Documentation for Actions
</span></span></span><span class=line><span class=cl><span class=go>  18) migrate-jsf-2.x-to-spring-boot
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Use joinfaces to integrate JSF 2.x with Spring Boot.
</span></span></span><span class=line><span class=cl><span class=go>  19) cn-spring-cloud-config-server
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Externalize properties to Spring Cloud Config Server
</span></span></span><span class=line><span class=cl><span class=go>  20) boot-2.4-2.5-upgrade-report
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create Upgrade Report for a Spring Boot 2.4 Application
</span></span></span><span class=line><span class=cl><span class=go>  21) boot-2.7-3.0-dependency-version-update
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Bump spring-boot-starter-parent from 2.7.x to 3.0.0
</span></span></span><span class=line><span class=cl><span class=go>  22) boot-autoconfiguration-update
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create org.springframework.boot.autoconfigure.AutoConfiguration.imports file for new spring 2.7
</span></span></span><span class=line><span class=cl><span class=go>  23) boot-2.4-2.5-datasource-initializer
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Replace deprecated spring.datasource.* properties
</span></span></span><span class=line><span class=cl><span class=go>  24) boot-2.4-2.5-spring-data-jpa
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Rename JpaRepository methods getId() and calls to getOne()
</span></span></span><span class=line><span class=cl><span class=go>  25) boot-2.4-2.5-dependency-version-update
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Update Spring Boot dependencies from 2.4 to 2.5
</span></span></span><span class=line><span class=cl><span class=go>  26) boot-2.7-3.0-upgrade-report
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create a report for Spring Boot Upgrade from 2.7.x to 3.0.0-M3
</span></span></span><span class=line><span class=cl><span class=go>  27) boot-2.4-2.5-sql-init-properties
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Replace deprecated spring.datasource.* properties
</span></span></span><span class=line><span class=cl><span class=go>  28) sbu30-report
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create a report for Spring Boot Upgrade from 2.7.x to 3.0.x
</span></span></span><span class=line><span class=cl><span class=go>  29) sbu30-upgrade-dependencies
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Upgrade dependencies
</span></span></span><span class=line><span class=cl><span class=go>  30) sbu30-set-java-version
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Set java version property in build file
</span></span></span><span class=line><span class=cl><span class=go>  31) sbu30-add-milestone-repositories
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Add milestone repository for dependencies and plugins
</span></span></span><span class=line><span class=cl><span class=go>  32) sbu30-migrate-spring-data-properties
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Migrate &#39;spring.data&#39; properties to new property names
</span></span></span><span class=line><span class=cl><span class=go>  33) sbu30-remove-construtor-binding
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Remove redundant @ConstructorBinding annotations
</span></span></span><span class=line><span class=cl><span class=go>  34) sbu30-migrate-to-jakarta-packages
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Migrate javax packages to new jakarta packages
</span></span></span><span class=line><span class=cl><span class=go>  35) sbu30-johnzon-dependency-update
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Specify version number for johnzon-core
</span></span></span><span class=line><span class=cl><span class=go>  36) sbu30-225-logging-date-format
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Logging Date Format
</span></span></span><span class=line><span class=cl><span class=go>  37) sbu30-auto-configuration
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Move EnableAutoConfiguration Property from spring.factories to AutoConfiguration.imports
</span></span></span><span class=line><span class=cl><span class=go>  38) sbu30-upgrade-spring-cloud-dependency
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Upgrade Spring Cloud Dependencies
</span></span></span><span class=line><span class=cl><span class=go>  39) sbu30-upgrade-boot-version
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Upgrade Spring Boot version
</span></span></span><span class=line><span class=cl><span class=go>  40) sbu30-remove-image-banner
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Remove the image banner at src/main/resources
</span></span></span><span class=line><span class=cl><span class=go>  41) sbu30-paging-and-sorting-repository
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Spring boot 3.0 Upgrade - Add CrudRepository interface extension additionally to PagingAndSortingRepository
</span></span></span><span class=line><span class=cl><span class=go>  42) migrate-raml-to-spring-mvc
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Create Spring Boot @RestController from .raml files.
</span></span></span><span class=line><span class=cl><span class=go>  43) migrate-boot-2.3-2.4
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate from Spring Boot 2.3 to 2.4
</span></span></span><span class=line><span class=cl><span class=go>  44) upgrade-boot-1x-to-2x
</span></span></span><span class=line><span class=cl><span class=go>     -&gt; Migrate applications built on previous versions of Spring Boot to the latest Spring Boot 2.7 release. 
</span></span></span></code></pre></div></figure></div><h2 id=spring-到-spring-boot-迁移示例>Spring 到 Spring Boot 迁移示例<a href=#spring-到-spring-boot-迁移示例 class=anchor aria-hidden=true>#</a></h2><p>下面介绍下我们将 Spring 项目迁移到 Spring Boot 的过程，以及中间遇到的一些问题。</p><table><thead><tr><th>升级项</th><th>迁移前</th><th>迁移后</th></tr></thead><tbody><tr><td>Runtime</td><td>Spring + Tomcat</td><td>Spring Boot 3.2</td></tr><tr><td>Spring</td><td>Spring 4</td><td>Spring 6</td></tr><tr><td>Junit</td><td>Junit 4</td><td>Junit 5</td></tr><tr><td>okhttp</td><td>okhttp 3</td><td>okhttp 4</td></tr><tr><td>Java</td><td>Java 8</td><td>Java 21</td></tr><tr><td>Java EE</td><td>Java EE</td><td>Jakarta EE</td></tr></tbody></table><p>基本步骤：</p><ol><li><p>使用 Spring Boot Migrator 将 Spring 项目转换成 Spring Boot，使用 Java 17 启动 spring-boot-migrator 程序并根据提示一步一步操作，如果某个步骤出错，根据 <code>stacktrace</code> 命令查看错误信息，修复后继续 <code>apply &lt;recipe-number></code>。</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=gp>#</span> 使用 Java <span class=m>17</span> 启动 spring-boot-migrator 程序
</span></span><span class=line><span class=cl><span class=gp>$</span> java -jar spring-boot-migrator.jar
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Get Started:
</span></span></span><span class=line><span class=cl><span class=go>------------
</span></span></span><span class=line><span class=cl><span class=go>Type
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&#34;help&#34; - to display a list all of the available commands.
</span></span></span><span class=line><span class=cl><span class=go>&#34;scan &lt;dir&gt;&#34; - to scan an application
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>--------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>migrator:&gt; scan my-spring-project-dir
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[ok] Found pom.xml.
</span></span></span><span class=line><span class=cl><span class=go>[ok] &#39;sbm.gitSupportEnabled&#39; is &#39;true&#39;, changes will be committed to branch [springboot] after each recipe.
</span></span></span><span class=line><span class=cl><span class=go>[ok] Found required source dir &#39;src/main/java&#39;.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Maven        100% │██████████████████████████████████│ 2/2 (0:00:00 / 0:00:00)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Applicable recipes:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>1) remove-redundant-maven-compiler-plugin
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Remove standard maven-compiler plugin for applications with boot parent.
</span></span></span><span class=line><span class=cl><span class=go>2) initialize-spring-boot-migration
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Initialize an application as Spring Boot application.
</span></span></span><span class=line><span class=cl><span class=go>3) spring-context-xml-import
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Import Spring Framework xml bean configuration into Java configuration without converting them.
</span></span></span><span class=line><span class=cl><span class=go>4) migrate-spring-xml-to-java-config
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Migrate Spring Framework xml bean configuration to Java configuration.
</span></span></span><span class=line><span class=cl><span class=go>5) cn-spring-cloud-config-server
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Externalize properties to Spring Cloud Config Server
</span></span></span><span class=line><span class=cl><span class=go>6) sbu30-set-java-version
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Set java version property in build file
</span></span></span><span class=line><span class=cl><span class=go>7) sbu30-add-milestone-repositories
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Add milestone repository for dependencies and plugins
</span></span></span><span class=line><span class=cl><span class=go>8) sbu30-225-logging-date-format
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Logging Date Format
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Run command &#39;&gt; apply &lt;recipe-number&gt;&#39; to apply a recipe.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ibss-site-dc:&gt; apply remove-redundant-maven-compiler-plugin
</span></span></span><span class=line><span class=cl><span class=go>Applying recipe &#39;remove-redundant-maven-compiler-plugin&#39;
</span></span></span><span class=line><span class=cl><span class=go>[ok] Clean up redundant properties for maven compiler plugin.
</span></span></span><span class=line><span class=cl><span class=go>[ok] Clean up redundant maven compiler plugin.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>remove-redundant-maven-compiler-plugin successfully applied the following actions:
</span></span></span><span class=line><span class=cl><span class=go>(x) Clean up redundant properties for maven compiler plugin.
</span></span></span><span class=line><span class=cl><span class=go>(x) Clean up redundant maven compiler plugin.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Applicable recipes:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>1) initialize-spring-boot-migration
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Initialize an application as Spring Boot application.
</span></span></span><span class=line><span class=cl><span class=go>2) spring-context-xml-import
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Import Spring Framework xml bean configuration into Java configuration without converting them.
</span></span></span><span class=line><span class=cl><span class=go>3) migrate-spring-xml-to-java-config
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Migrate Spring Framework xml bean configuration to Java configuration.
</span></span></span><span class=line><span class=cl><span class=go>4) cn-spring-cloud-config-server
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Externalize properties to Spring Cloud Config Server
</span></span></span><span class=line><span class=cl><span class=go>5) sbu30-set-java-version
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Set java version property in build file
</span></span></span><span class=line><span class=cl><span class=go>6) sbu30-add-milestone-repositories
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Add milestone repository for dependencies and plugins
</span></span></span><span class=line><span class=cl><span class=go>7) sbu30-225-logging-date-format
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Logging Date Format
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Run command &#39;&gt; apply &lt;recipe-number&gt;&#39; to apply a recipe.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ibss-site-dc:&gt; apply initialize-spring-boot-migration
</span></span></span><span class=line><span class=cl><span class=go>Applying recipe &#39;initialize-spring-boot-migration&#39;
</span></span></span><span class=line><span class=cl><span class=go>[ok] Add Spring Boot dependency management section to buildfile.
</span></span></span><span class=line><span class=cl><span class=go>[ok] Add Spring Boot starter class.
</span></span></span><span class=line><span class=cl><span class=go>[ok] Add initial unit test class to test Spring Boot Application Context startup.
</span></span></span><span class=line><span class=cl><span class=go>[ok] Set packaging to &#39;jar&#39; type if different
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>initialize-spring-boot-migration successfully applied the following actions:
</span></span></span><span class=line><span class=cl><span class=go>(x) Add Spring Boot dependency management section to buildfile.
</span></span></span><span class=line><span class=cl><span class=go>(x) Add spring dependencies &#39;spring-boot-starter&#39; and &#39;spring-boot-starter-test&#39;.
</span></span></span><span class=line><span class=cl><span class=go>(x) Delete dependencies to artifacts transitively managed by Spring Boot.
</span></span></span><span class=line><span class=cl><span class=go>(x) Add Spring Boot Maven plugin.
</span></span></span><span class=line><span class=cl><span class=go>(x) Add Spring Boot starter class.
</span></span></span><span class=line><span class=cl><span class=go>(x) Add initial unit test class to test Spring Boot Application Context startup.
</span></span></span><span class=line><span class=cl><span class=go>(x) Set packaging to &#39;jar&#39; type if different
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Applicable recipes:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>1) spring-context-xml-import
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Import Spring Framework xml bean configuration into Java configuration without converting them.
</span></span></span><span class=line><span class=cl><span class=go>2) migrate-spring-xml-to-java-config
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Migrate Spring Framework xml bean configuration to Java configuration.
</span></span></span><span class=line><span class=cl><span class=go>3) cn-spring-cloud-config-server
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Externalize properties to Spring Cloud Config Server
</span></span></span><span class=line><span class=cl><span class=go>4) boot-2.7-3.0-dependency-version-update
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Bump spring-boot-starter-parent from 2.7.x to 3.0.0
</span></span></span><span class=line><span class=cl><span class=go>5) boot-2.7-3.0-upgrade-report
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Create a report for Spring Boot Upgrade from 2.7.x to 3.0.0-M3
</span></span></span><span class=line><span class=cl><span class=go>6) sbu30-report
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Create a report for Spring Boot Upgrade from 2.7.x to 3.0.x
</span></span></span><span class=line><span class=cl><span class=go>7) sbu30-upgrade-dependencies
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Upgrade dependencies
</span></span></span><span class=line><span class=cl><span class=go>8) sbu30-set-java-version
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Set java version property in build file
</span></span></span><span class=line><span class=cl><span class=go>9) sbu30-add-milestone-repositories
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Add milestone repository for dependencies and plugins
</span></span></span><span class=line><span class=cl><span class=go>10) sbu30-remove-construtor-binding
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Remove redundant @ConstructorBinding annotations
</span></span></span><span class=line><span class=cl><span class=go>11) sbu30-225-logging-date-format
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Logging Date Format
</span></span></span><span class=line><span class=cl><span class=go>12) sbu30-upgrade-spring-cloud-dependency
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Upgrade Spring Cloud Dependencies
</span></span></span><span class=line><span class=cl><span class=go>13) sbu30-upgrade-boot-version
</span></span></span><span class=line><span class=cl><span class=go>   -&gt; Spring boot 3.0 Upgrade - Upgrade Spring Boot version
</span></span></span></code></pre></div></figure></div></li><li><p>Spring Boot Migrator 目前还并不成熟，以上步骤中很多 <code>recipe</code> 可能出错，所以我只用 Spring Boot Migrator 做一些基础初始化，其他任务使用 rewrite-maven-plugin，交给 openrewrite 执行。在 maven pom.xml 中增加以下配置后，执行 <code>mvn rewrite:run</code>。</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>   <span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;groupId&gt;</span>org.openrewrite.maven<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;artifactId&gt;</span>rewrite-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;version&gt;</span>5.19.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;activeRecipes&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;recipe&gt;</span>org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_7<span class=nt>&lt;/recipe&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;recipe&gt;</span>org.openrewrite.java.testing.junit5.JUnit4to5Migration<span class=nt>&lt;/recipe&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;recipe&gt;</span>org.openrewrite.okhttp.UpgradeOkHttp4<span class=nt>&lt;/recipe&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;recipe&gt;</span>org.openrewrite.okhttp.ReorderRequestBodyCreateArguments<span class=nt>&lt;/recipe&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;recipe&gt;</span>org.openrewrite.java.migrate.UpgradeToJava17<span class=nt>&lt;/recipe&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/activeRecipes&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/configuration&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.openrewrite.recipe<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>rewrite-spring<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>5.2.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.openrewrite.recipe<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>rewrite-testing-frameworks<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>2.2.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.openrewrite.recipe<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>rewrite-okhttp<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>0.1.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.openrewrite.recipe<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>rewrite-migrate-java<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>2.5.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/plugin&gt;</span></span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[INFO] Using active recipe(s) [org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_7, org.openrewrite.java.testing.junit5.JUnit4to5Migration]
</span></span></span><span class=line><span class=cl><span class=go>[INFO] Using active styles(s) []
</span></span></span><span class=line><span class=cl><span class=go>[INFO] Validating active recipes...
</span></span></span><span class=line><span class=cl><span class=go>[INFO] Project [ibss-site-dc] Resolving Poms...
</span></span></span><span class=line><span class=cl><span class=go>[INFO] Project [ibss-site-dc] Parsing source files
</span></span></span><span class=line><span class=cl><span class=go>[INFO] Running recipe(s)...
</span></span></span><span class=line><span class=cl><span class=go>[WARNING] Changes have been made to pom.xml by:
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]     org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_7
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]         org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_6
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]             org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_5
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                 org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_4
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                     org.openrewrite.java.spring.boot2.SpringBoot2JUnit4to5Migration
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                         org.openrewrite.java.testing.junit5.JUnit4to5Migration
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                             org.openrewrite.maven.ExcludeDependency: {groupId=junit, artifactId=junit}
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]         org.openrewrite.java.dependencies.UpgradeDependencyVersion: {groupId=org.springframework.boot, artifactId=*, newVersion=2.7.x, overrideManagedVersion=false}
</span></span></span><span class=line><span class=cl><span class=go>[WARNING] Changes have been made to src/main/java/com/fsde/ibss/dc/controller/ClientController.java by:
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]     org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_7
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]         org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_6
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]             org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_5
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                 org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_4
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                     org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_3
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                         org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_2
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                             org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_1
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                 org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_0
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                     org.openrewrite.java.spring.boot2.SpringBoot2BestPractices
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                         org.openrewrite.java.spring.NoRequestMappingAnnotation
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                         org.openrewrite.java.spring.ImplicitWebAnnotationNames
</span></span></span><span class=line><span class=cl><span class=go>[WARNING] Changes have been made to src/test/java/com/fsde/ibss/dc/service/FileSaveTest.java by:
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]     org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_7
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]         org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_6
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]             org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_5
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                 org.openrewrite.java.spring.boot2.UpgradeSpringBoot_2_4
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                     org.openrewrite.java.spring.boot2.SpringBoot2JUnit4to5Migration
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                         org.openrewrite.java.testing.junit5.JUnit4to5Migration
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                             org.openrewrite.java.testing.junit5.UpdateTestAnnotation
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                         org.openrewrite.java.spring.boot2.RemoveObsoleteSpringRunners
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                             org.openrewrite.java.testing.junit5.JUnit5BestPractices
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                 org.openrewrite.java.testing.cleanup.RemoveTestPrefix
</span></span></span><span class=line><span class=cl><span class=go>[WARNING]                                 org.openrewrite.java.testing.cleanup.TestsShouldNotBePublic
</span></span></span><span class=line><span class=cl><span class=go>[WARNING] Please review and commit the results.
</span></span></span><span class=line><span class=cl><span class=go>[INFO] ------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go>[INFO] BUILD SUCCESS
</span></span></span><span class=line><span class=cl><span class=go>[INFO] ------------------------------------------------------------------------
</span></span></span></code></pre></div></figure></div></li><li><p>在上面步骤我是先升级到了 Spring Boot 2，然后再执行升级 Spring Boot 3 和 Jakarta EE。实际上直接升级到 Spring Boot 3 也是可以的。</p></li><li><p>执行完成后可从 maven 中删除 rewrite-maven-plugin，也可留着下次做其他变更。</p></li></ol><p>注意事项：</p><ol><li>我们项目配置都是通过远程配置中心管理的，所以升级过程中配置文件无法响应变更，解决办法是将配置从远端拷贝到本地 applicaiton.properties 中，执行完任务后根据变化再更新远程配置中心。</li><li>执行过程中可能会报错，比如 maven 插件升级后某些属性可能变更或失效，需要手动解决错误后，再执行 <code>mvn rewrite:run</code>，</li><li>可重复执行 <code>mvn rewrite:run</code> 命令，可随时加入新的 recipe 再执行，所以为了观察变更和保证执行成功，可分批次加入 recipe 多次执行。</li><li>OpenRewrite 不解析依赖的第三方 jar 包内容，所以第三方 jar 的问题需要自行识别，比如从 Java EE 到 Jakarta EE，只是替换规则中知道的 jar 包版本，不会自动把 jar 包内的 <code>javax.</code> 替换为 <code>jakarta.</code> 。</li></ol><h2 id=未完待续>未完待续<a href=#未完待续 class=anchor aria-hidden=true>#</a></h2><p>此文将持续更新，继续介绍：</p><ul><li>OpenRewrite 最佳实践</li><li>OpenRewrite recipes 依赖关系，各种场景下如果搜索和使用 recipes</li><li>OpenRewrite 代码分析原理，如何自定义 recipes</li></ul><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/gethyas/getdoks.org/blob/main/content//docs/java/openrewrite.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/docs/platform/%E6%99%BA%E8%83%BD%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/ class="stretched-link text-reset text-decoration-none">智能代码重构</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/docs/guides/%E4%BB%8E-1024-%E5%88%B0-512/ class="stretched-link text-reset text-decoration-none">从 1024 到 512</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div><span id=docsearch-lvl0 hidden>Java</span></div></div><footer class="footer text-muted"><div class=container-fluid><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=https://gethyas.com/privacy/>Privacy Policy</a></li><li class=list-inline-item><a class=text-muted href=https://gethyas.com/terms/>Terms of Service</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/bootstrap.7424592a74f2abbd0e29e7fc0656f4c7dc9630431d965a120786ab31209b1d3c.js integrity="sha256-dCRZKnTyq70OKef8Blb0x9yWMEMdlloSB4arMSCbHTw="></script><script async src=/js/app.47b84f3b640408af6efe7bf4add1a36f5b9c6227fbae7b8bcdf0c9ce42fefc54.js integrity="sha256-R7hPO2QECK9u/nv0rdGjb1ucYif7rnuLzfDJzkL+/FQ="></script><script async src=/js/docsearch.eea9eb8dbc5909d5950b8b65434f0ac066dc70eae0ac4f16d45bca692f1029f4.js integrity="sha256-7qnrjbxZCdWVC4tlQ08KwGbccOrgrE8W1FvKaS8QKfQ="></script></body></html>